<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Trader Application</title>
    <link rel="stylesheet" href="app.css">
</head>
<body>
    <nav class="navbar">        
        <label class="logo">TRADâ‚¬R</label>      
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="tickers.html">Tickers</a></li>
<!--            <li><a href="#">Service</a></li>-->
<!--            <li><a href="#">Contact</a></li>-->
<!--            <li><a href="#">Feedback</a></li>-->
        </ul>

    </nav>

    <main>
        <div class="container">
            <div class="div1">
                <label class="label" for="host" >HOST</label><br>
                <input class="input" type="text" id="host" placeholder="Host IP" value="127.0.0.1">

            </div>
            <div class="div1">
                <label class="label" for="port">PORT</label><br>
                <input class="input" type="text" id="port" placeholder="Port" value="7400" size="8">
            </div>
            <div class="div1">
                <label class="label" for="clientId">ID</label><br>
                <input class="input" type="text" id="clientId" placeholder="Client ID" value="0" size="5">
            </div>
        </div>
        <div class="container" >
            <input class="button" type="button" id="connectionDetails" name="Connect" value="Connect" size="5">            
        </div>

        <br>

        <div class="container">
            <div class="div1">
                <label class="label" for="stradegy">STRADEGY</label><br>
                <input class="input" type="text" id="stradegy" placeholder="QUICK" size="15">
            </div>
            <div class="div1">
                <label class="label" for="orderSymbol">SYMBOL</label><br>
                <input class="input" type="text" id="orderSymbol" placeholder="AAPL" size="15">
            </div>
            <div class="div1">
                <label class="label" for="orderAction">ORDER ACTION</label><br>
                <input class="input" type="text" id="orderAction" placeholder="BUY/SELL/SHORT" size="15">
            </div>
            <div class="div1">
                <label class="label" for="orderType">ORDER TYPE</label><br>
                <input class="input" type="text" id="orderType" placeholder="LIMIT/MARKET" size="15">
            </div>            
        </div>
        <div class="container">
            <div class="div1">
                <label class="label" for="quantity">QUANTITY</label><br>
                <input class="input" type="text" id="quantity" placeholder="100" size="15">
            </div>
            <div class="div1">
                <label class="label" for="limitPrice">LIMIT PRICE</label><br>
                <input class="input" type="text" id="limitPrice" placeholder="$" size="15">
            </div>
            <div class="div1">
                <label class="label" for="stopLoss">STOP LOSS</label><br>
                <input class="input" type="text" id="stopLoss" placeholder="$" size="15">
            </div>
            <div class="div1">
                <label class="label" for="profitTaker">PROFIT TAKER</label><br>
                <input class="input" type="text" id="profitTaker" placeholder="$" size="15">
            </div> 
        </div>
        <div class="container">
            <div class="div1">
                <label class="label" for="valid">VALID TYPE</label><br>
                <input class="input" type="text" id="valid" placeholder="DAY/GTC" >
            </div>
        </div>
        <div class="container" >
            <input class="button" type="button" id="placeOrder" name="placeOrder" value="Place Order" size="5">            
        </div>
        <br>        

        
    </main>

    <script>
        let host = document.getElementById("host");
        let port = document.getElementById("port");
        let clientID = document.getElementById("clientId");
        let connectButton = document.getElementById("connectionDetails");    

        connectButton.onclick = function connectToTWS() {
            fetch('/connect', {
                method: 'POST',
                cache: 'no-cache',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    ip: host.value,
                    port: port.value,
                    clientId: clientID.value,
                    connectionOpt: ""
                })
            })
                .then(function(response) {
                return response.json();
                })
                .then(function(jsonData) {
                    console.log(jsonData);
                })
                .catch(function(err) {
                    console.log(err);
                });
        }

        let algoId = document.getElementById("stradegy");
        let orderSymbol = document.getElementById("orderSymbol");
        let orderAction = document.getElementById("orderAction");
        let orderType = document.getElementById("orderType");
        let quantity = document.getElementById("quantity");
        let limitPrice = document.getElementById("limitPrice");
        let stopLoss = document.getElementById("stopLoss");
        let profitTaker = document.getElementById("profitTaker");
        let valid = document.getElementById("valid");
        let placeOrderButton = document.getElementById("placeOrder");

        placeOrderButton.onclick = function placeOrder() {
            fetch('/placeorder', {
                method: 'POST',
                cache: 'no-cache',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    algoId: algoId.value,
                    symbol: orderSymbol.value,
                    orderType: orderType.value,
                    orderAction: orderAction.value,
                    quantity: quantity.value,
                    limitPrice: limitPrice.value,
                    stopLoss: stopLoss.value,
                    profitTaker: profitTaker.value,
                    valid: valid.value
                })
            })/*
                .then(function(response) {
                return response.json();
                })
                .then(function(jsonData) {
                    console.log(jsonData);
                })
                .catch(function(err) {
                    console.log(err);
                });
                */
        }
    </script>
</body>
</html>